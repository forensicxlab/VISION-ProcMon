<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>VISON - ProcMon</title>
</head>

<body>
  <div class="container-fluid">
    <div id="import_section" class="d-none d-flex flex-column min-vh-100 justify-content-center align-items-center">
      <div class="col-12">
        <div class="d-flex justify-content-center align-items-center">
          <h1 id="title">VISION - ProcMon</h1>
        </div>
        <div class="d-flex justify-content-center align-items-center">
          <img id="logo" src="/assets/vision_procmon.svg" style="width: 20%;">
        </div>
      </div>
      <div class="col-6" id="input_form">
        <div class="d-flex justify-content-center align-items-center">
          <div class="input-group">
            <div class="input-group mb-3">
              <input type="text" class="form-control" placeholder="ProcMon CSV full path" id="file_input">
              <button class="btn btn-outline-secondary disabled"  id="load_btn" type="button">Load</button>
            </div>
          </div>
        </div>
      </div>

      <div id="loading_scan" class="d-flex flex-column align-items-center justify-content-center">
        <div class="row">
        <svg width="70px" height="70px" viewBox="0 0 34.083462 23.477665" version="1.1" id="svg5" sodipodi:docname="test.svg" inkscape:version="1.2 (dc2aeda, 2022-05-15)" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg">
          <sodipodi:namedview id="namedview7" pagecolor="#ffffff" bordercolor="#000000" borderopacity="0.25" inkscape:showpageshadow="2" inkscape:pageopacity="0.0" inkscape:pagecheckerboard="0" inkscape:deskcolor="#d1d1d1" inkscape:document-units="mm" showgrid="false" inkscape:zoom="3.659624" inkscape:cx="18.444518" inkscape:cy="21.177039" inkscape:window-width="3114" inkscape:window-height="1273" inkscape:window-x="0" inkscape:window-y="25" inkscape:window-maximized="0" inkscape:current-layer="layer1"></sodipodi:namedview>
          <defs id="defs2"></defs>
          <g inkscape:label="Calque 1" inkscape:groupmode="layer" id="layer1" transform="translate(-89.435083,-70.283201)">
            <ellipse style="fill: rgb(0, 0, 0); fill-opacity: 1; stroke: none; stroke-width: 1.61977px;" id="ellipse2195" cx="104.97663" cy="83.287247" rx="3.0338492" ry="3.1317153" class="svg-elem-1"></ellipse>
            <path style="fill: none; stroke: rgb(0, 0, 0); stroke-width: 0.318261px; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 4; stroke-opacity: 1;" d="M 104.91635,83.567335 C 104.65847,83.438397 90.719421,74.477222 90.719421,74.477222" id="path2075" sodipodi:nodetypes="cc" class="svg-elem-2"></path>
            <path style="fill: none; stroke: rgb(0, 0, 0); stroke-width: 0.318261px; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 4; stroke-opacity: 1;" d="M 116.92545,91.370663 C 116.66757,91.241725 102.72852,82.28055 102.72852,82.28055" id="path2075-1" sodipodi:nodetypes="cc" class="svg-elem-3"></path>
            <path style="fill: none; stroke: rgb(0, 0, 0); stroke-width: 0.318261px; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 4; stroke-opacity: 1;" d="M 105.21318,83.200994 C 104.9553,83.072056 104.89746,71.435856 104.89746,71.435856" id="path2075-5" sodipodi:nodetypes="cc" class="svg-elem-4"></path>
            <path style="fill: none; stroke: rgb(0, 0, 0); stroke-width: 0.318261px; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 4; stroke-opacity: 1;" d="m 105.15757,83.115909 c -0.25788,-0.128938 14.17599,-10.112561 14.17599,-10.112561" id="path2075-9" sodipodi:nodetypes="cc" class="svg-elem-5"></path>
            <path style="fill: none; stroke: rgb(0, 0, 0); stroke-width: 0.318261px; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 4; stroke-opacity: 1;" d="M 92.501834,93.037163 C 92.243954,92.908225 106.67782,82.924602 106.67782,82.924602" id="path2075-9-7" sodipodi:nodetypes="cc" class="svg-elem-6"></path>
            <path style="fill: none; stroke: rgb(0, 0, 0); stroke-width: 0.318261px; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 4; stroke-opacity: 1;" d="m 107.25062,84.144515 c -0.25788,-0.128938 15.47736,2.105794 15.47736,2.105794" id="path2075-9-6" sodipodi:nodetypes="cc" class="svg-elem-7"></path>
            <path style="fill: none; stroke: rgb(0, 0, 0); stroke-width: 0.318261px; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 4; stroke-opacity: 1;" d="M 105.15397,83.783025 C 104.89609,83.654087 92.652016,86.90099 92.652016,86.90099" id="path2075-9-1" sodipodi:nodetypes="cc" class="svg-elem-8"></path>
            <path style="fill: none; stroke: rgb(0, 0, 0); stroke-width: 0.318261px; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 4; stroke-opacity: 1;" d="m 105.86237,83.829446 c -0.25788,-0.128938 -0.78968,7.600438 -0.78968,7.600438" id="path2075-9-1-2" sodipodi:nodetypes="cc" class="svg-elem-9"></path>
            <ellipse style="fill: rgb(0, 0, 0); fill-opacity: 1; stroke: none; stroke-width: 0.481153px;" id="ellipse2069" cx="90.336296" cy="74.177704" rx="0.90121293" ry="0.93028438" class="svg-elem-10"></ellipse>
            <ellipse style="fill: rgb(0, 0, 0); fill-opacity: 1; stroke: none; stroke-width: 0.481153px;" id="ellipse2069-1" cx="92.685982" cy="92.830582" rx="0.90121293" ry="0.93028438" class="svg-elem-11"></ellipse>
            <ellipse style="fill: rgb(0, 0, 0); fill-opacity: 1; stroke: none; stroke-width: 0.481153px;" id="ellipse2069-9" cx="119.42187" cy="73.053871" rx="0.90121293" ry="0.93028438" class="svg-elem-12"></ellipse>
            <ellipse style="fill: rgb(0, 0, 0); fill-opacity: 1; stroke: none; stroke-width: 0.481153px;" id="ellipse2069-9-4" cx="117.05038" cy="91.529213" rx="0.90121293" ry="0.93028438" class="svg-elem-13"></ellipse>
            <ellipse style="fill: rgb(0, 0, 0); fill-opacity: 1; stroke: none; stroke-width: 0.481153px;" id="ellipse2069-9-8" cx="104.90433" cy="71.213486" rx="0.90121293" ry="0.93028438" class="svg-elem-14"></ellipse>
            <ellipse style="fill: rgb(0, 0, 0); fill-opacity: 1; stroke: none; stroke-width: 0.481153px;" id="ellipse2069-9-7" cx="92.541389" cy="86.974442" rx="0.90121293" ry="0.93028438" class="svg-elem-15"></ellipse>
            <ellipse style="fill: rgb(0, 0, 0); fill-opacity: 1; stroke: none; stroke-width: 0.481153px;" id="ellipse2069-9-7-5" cx="122.61733" cy="86.323761" rx="0.90121293" ry="0.93028438" class="svg-elem-16"></ellipse>
            <ellipse style="fill: rgb(0, 0, 0); fill-opacity: 1; stroke: none; stroke-width: 0.481153px;" id="ellipse2069-9-7-3" cx="105.04893" cy="91.529213" rx="0.90121293" ry="0.93028438" class="svg-elem-17"></ellipse>
          </g>
        </svg>
        </div>
        <div class="row mt-3">
         <strong>Please wait while VISION is processing your file</strong>
       </div>
      </div>
      <div class="col-6" id="title-2">
        <div class="d-flex justify-content-center align-items-center">
          <h3 class="h3">Choose the process you want to investigate</h3>
        </div>
      </div>
      <div class="col-6" id="process_picker">
        <div class="d-flex justify-content-center align-items-center">
          <div class="input-group mb-3 input_select">
            <select class="form-select form-select-sm" aria-label=".form-select-sm example" id="process_select" aria-describedby="generate_btn">

            </select>
            <button class="btn btn-outline-success" type="button" id="generate_btn">Apply</button>
          </div>
        </div>
        
       </div>
      </div>
    </div>

  </div>


  <div class="row h-100" style="overflow-y: scroll;">
    <div class="col-2 bg-dark">
      <div class="row" >
        <div class="col-12">
          <div class="d-flex justify-content-center align-items-center">
            <img id="logo" src="/assets/vision_procmon.svg" style="width: 20%;">
          </div>
        </div>
        <div class="col-12">
          <div id="process_info">
            <div class="card border-warning text-bg-dark">
              <div class="card-header border-warning">
                Current process information.
              </div>
              <div class="card-body">
                <span id="card_process_name"></span>
                  <br>
                  <span id="card_process_pid"></span>
                  <br>
                  <span id="card_process_cmdline" class="text-break"></span>
                <br>
              </div>
            </div>
          </div>
        </div>
        <div class="col-12">
          <div id="registry_actions" class="mt-2">
            <div class="card border-warning text-bg-dark">
              <div class="card-header border-warning">
                Filter
              </div>
              <div class="card-body">
                <div class="row g-3 align-items-center">
                    <div class="col-auto">
                      <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" role="switch" id="RegCreateKey_filter">
                        <label class="form-check-label">Registry key creation</label>
                      </div>
                    </div>
                    <div class="col-auto">
                      <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" role="switch" id="RegDeleteKey_filter">
                        <label class="form-check-label">Registry key deletion</label>
                      </div>
                    </div>
                    <div class="col-auto">
                      <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox"  role="switch" id="RegSetValue_filter">
                        <label class="form-check-label" checked>Registry set values</label>
                      </div>
                    </div>
                    <div class="col-auto">
                      <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox"  role="switch" id="RegDeleteValue_filter">
                        <label class="form-check-label" checked>Registry delete values</label>
                      </div>
                    </div>
                    <div class="col-auto">
                      <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox"  role="switch" id="File_filter">
                        <label class="form-check-label" checked>File operations</label>
                      </div>
                    </div>
                    <div class="col-auto">
                      <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox"  role="switch" id="Network_filter">
                        <label class="form-check-label" checked>Network operations</label>
                      </div>
                    </div>
                  </div>  
              </div>
            </div>
          </div>
        </div>
        <div class="col-12">
          <hr class="bg-warning border-2 border-top border-warning">
        </div>
        <div class="col-12">
          <div id="details_info">
            <div class="card border-warning text-bg-dark">
              <div class="card-header border-warning">
                Details
              </div>
              <span id="card_details" class="text-break"></span>
              <div class="card-body" id="details_body">
              </div>
            </div>
          </div>          
        </div>
      </div>
   </div>
    <div class="col-10">
      <div id="sigma-container"></div>
    </div>
  </div>


  <div id="main-menu" class="d-flex">
    <div id ="process_filter">
    </div>
    <div id ="quit">
      <button type="button" class="btn btn-outline-dark" id="quit_btn">Quit</button>
    </div>
  </div>



  




  <div class="toast-container position-fixed bottom-0 end-0 p-3">
    <div class="toast align-items-center text-bg-primary border-0" id="info-toast" role="alert" aria-live="assertive" aria-atomic="true">
      <div class="d-flex">
        <div class="toast-body" id="info-message">
          
        </div>
        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
      </div>
    </div>

    <div class="toast align-items-center text-bg-danger border-0" id="error-toast" role="alert" aria-live="assertive" aria-atomic="true">
      <div class="d-flex">
        <div class="toast-body" id="error-message">
          
        </div>
        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
      </div>
    </div>
  </div>

  <script type="module" src="main.ts"></script>
</body>
</html>